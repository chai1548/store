<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Social App with Firebase</title>
    
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK v9 -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
        import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, onSnapshot, serverTimestamp, query, orderBy, limit } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';
        import { getStorage, ref, uploadBytes, getDownloadURL, uploadBytesResumable } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-storage.js';

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB49vRPX8YaWuTP5GS3lsBDqdAaz_hJYAw",
            authDomain: "onlineshop-849c8.firebaseapp.com",
            databaseURL: "https://onlineshop-849c8.firebaseio.com",
            projectId: "onlineshop-849c8",
            storageBucket: "onlineshop-849c8.appspot.com",
            messagingSenderId: "883512833370",
            appId: "1:883512833370:web:a1c8412b158f8744afef63"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Make Firebase services available globally
        window.firebaseAuth = auth;
        window.firebaseDB = db;
        window.firebaseStorage = storage;
        window.firebaseServices = {
            signInWithEmailAndPassword,
            createUserWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            GoogleAuthProvider,
            signInWithPopup,
            collection,
            addDoc,
            getDocs,
            doc,
            updateDoc,
            deleteDoc,
            onSnapshot,
            serverTimestamp,
            query,
            orderBy,
            limit,
            ref,
            uploadBytes,
            getDownloadURL,
            uploadBytesResumable
        };

        // Initialize app when Firebase is ready
        document.addEventListener('DOMContentLoaded', function() {
            if (window.initializeApp) {
                window.initializeApp();
            }
        });
    </script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 1rem;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 1.5rem;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .nav-link {
            position: relative;
            padding: 0.75rem 1.5rem;
            margin: 0 0.25rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            color: white;
            text-decoration: none;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
            font-weight: 600;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .upload-zone {
            border: 2px dashed rgba(102, 126, 234, 0.5);
            border-radius: 1rem;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.05);
        }

        .upload-zone:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.1);
        }

        .post-image, .post-video {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 0.5rem;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: linear-gradient(135deg, #4ade80, #22c55e);
        }

        .notification.error {
            background: linear-gradient(135deg, #f87171, #ef4444);
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s ease;
        }

        .comment-input {
            border: 1px solid #e2e8f0;
            border-radius: 2rem;
            padding: 0.75rem 1rem;
            width: 100%;
            focus:outline-none;
            focus:ring-2;
            focus:ring-indigo-500;
        }

        .story-ring {
            background: linear-gradient(135deg, #667eea, #764ba2, #f093fb);
            padding: 3px;
            border-radius: 50%;
        }

        .story-inner {
            background: white;
            border-radius: 50%;
            padding: 2px;
        }

        @media print {
            body {
                background: white !important;
            }
            
            .app-container {
                max-width: 100% !important;
                padding: 0 !important;
            }
            
            .hide-in-print {
                display: none !important;
            }
            
            .card {
                break-inside: avoid;
                page-break-inside: avoid;
                margin-bottom: 1rem;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Welcome to SocialApp</h2>
                <p class="text-gray-600">Sign in to continue</p>
            </div>
            
            <div id="authTabs" class="flex mb-6">
                <button id="loginTab" class="flex-1 py-2 px-4 text-center border-b-2 border-indigo-500 text-indigo-600 font-semibold">Login</button>
                <button id="registerTab" class="flex-1 py-2 px-4 text-center border-b-2 border-gray-200 text-gray-500">Register</button>
            </div>
            
            <form id="authForm">
                <div class="mb-4">
                    <input type="email" id="authEmail" placeholder="Email address" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
                </div>
                <div class="mb-4">
                    <input type="password" id="authPassword" placeholder="Password" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required>
                </div>
                <div id="registerFields" class="hidden">
                    <div class="mb-4">
                        <input type="text" id="authName" placeholder="Full Name" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    </div>
                </div>
                <button type="submit" class="w-full btn-primary mb-4">
                    <span id="authButtonText">Sign In</span>
                </button>
            </form>
            
            <div class="text-center">
                <div class="mb-4 text-gray-500">or</div>
                <button id="googleAuth" class="w-full bg-red-500 hover:bg-red-600 text-white py-3 px-4 rounded-lg font-semibold flex items-center justify-center">
                    <i class="fab fa-google mr-2"></i>
                    Continue with Google
                </button>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="glass-effect">
        <div class="app-container">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-white mr-4">
                        <i class="fas fa-share-alt mr-2"></i>SocialApp
                    </h1>
                    <span class="bg-white bg-opacity-20 text-white text-xs font-semibold px-3 py-1 rounded-full">Firebase</span>
                </div>
                
                <div class="flex items-center space-x-2">
                    <div id="userInfo" class="hidden flex items-center space-x-3">
                        <img id="userAvatar" src="" alt="User" class="user-avatar">
                        <span id="userName" class="text-white font-medium"></span>
                        <button id="logoutBtn" class="text-white hover:text-red-300 transition-colors">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="mainNav" class="hidden flex space-x-2 pb-4">
                <a href="#" class="nav-link active" data-page="home">
                    <i class="fas fa-home mr-2"></i>Home
                </a>
                <a href="#" class="nav-link" data-page="upload">
                    <i class="fas fa-plus mr-2"></i>Create
                </a>
                <a href="#" class="nav-link" data-page="profile">
                    <i class="fas fa-user mr-2"></i>Profile
                </a>
                <a href="#" class="nav-link" data-page="settings">
                    <i class="fas fa-cog mr-2"></i>Settings
                </a>
            </div>
        </div>
    </nav>

    <main class="app-container py-6">
        <!-- Home Page -->
        <div id="home-page" class="page active">
            <!-- Stories Section -->
            <div class="card glass-effect mb-6">
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-white mb-4">Stories</h3>
                    <div class="flex space-x-4 overflow-x-auto">
                        <div class="flex-shrink-0 text-center cursor-pointer">
                            <div class="story-ring w-16 h-16 mx-auto mb-2">
                                <div class="story-inner w-full h-full flex items-center justify-center">
                                    <i class="fas fa-plus text-gray-400"></i>
                                </div>
                            </div>
                            <p class="text-xs text-white">Add Story</p>
                        </div>
                        
                        <div class="flex-shrink-0 text-center cursor-pointer">
                            <div class="story-ring w-16 h-16 mx-auto mb-2">
                                <div class="story-inner w-full h-full">
                                    <img src="https://images.unsplash.com/photo-1494790108755-2616b612b1e5?w=64&h=64&fit=crop&crop=face" alt="Story" class="w-full h-full object-cover rounded-full">
                                </div>
                            </div>
                            <p class="text-xs text-white">Sarah</p>
                        </div>
                        
                        <div class="flex-shrink-0 text-center cursor-pointer">
                            <div class="story-ring w-16 h-16 mx-auto mb-2">
                                <div class="story-inner w-full h-full">
                                    <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=64&h=64&fit=crop&crop=face" alt="Story" class="w-full h-full object-cover rounded-full">
                                </div>
                            </div>
                            <p class="text-xs text-white">John</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Posts Feed -->
            <div id="postsContainer">
                <!-- Sample Text Post -->
                <div class="card fade-in">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face" alt="User" class="user-avatar mr-4">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">Alex Johnson</h4>
                                <p class="text-sm text-gray-500">2 hours ago</p>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-gray-800 mb-3">Just finished building an amazing Firebase-powered social app! 🚀 The real-time features are incredible and the file upload system works seamlessly. Can't wait to share more about this project!</p>
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">#firebase</span>
                                <span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">#webdev</span>
                                <span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">#socialapp</span>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center py-3 border-t border-gray-100">
                            <button class="flex items-center text-gray-600 hover:text-red-500 transition-colors">
                                <i class="far fa-heart mr-2"></i>
                                <span>24 Likes</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-indigo-500 transition-colors">
                                <i class="far fa-comment mr-2"></i>
                                <span>8 Comments</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-green-500 transition-colors">
                                <i class="fas fa-share mr-2"></i>
                                <span>Share</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sample Image Post -->
                <div class="card fade-in">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <img src="https://images.unsplash.com/photo-1494790108755-2616b612b1e5?w=50&h=50&fit=crop&crop=face" alt="User" class="user-avatar mr-4">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">Sarah Wilson</h4>
                                <p class="text-sm text-gray-500">1 day ago</p>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                        </div>
                        
                        <div class="mb-4">
                            <p class="text-gray-800 mb-3">Beautiful sunset from my evening walk! 🌅 Nature never fails to amaze me with its incredible colors and peaceful moments.</p>
                            <img src="https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=400&fit=crop" alt="Sunset" class="post-image mb-3">
                            <div class="flex flex-wrap gap-2">
                                <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full">#sunset</span>
                                <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full">#nature</span>
                                <span class="bg-orange-100 text-orange-800 text-xs px-2 py-1 rounded-full">#photography</span>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center py-3 border-t border-gray-100">
                            <button class="flex items-center text-gray-600 hover:text-red-500 transition-colors">
                                <i class="far fa-heart mr-2"></i>
                                <span>156 Likes</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-indigo-500 transition-colors">
                                <i class="far fa-comment mr-2"></i>
                                <span>23 Comments</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-green-500 transition-colors">
                                <i class="fas fa-share mr-2"></i>
                                <span>Share</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="text-center mt-8">
                <button id="loadMoreBtn" class="btn-primary">
                    <i class="fas fa-plus mr-2"></i>Load More Posts
                </button>
            </div>
        </div>

        <!-- Upload Page -->
        <div id="upload-page" class="page">
            <div class="card">
                <div class="p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Create New Post</h2>
                    
                    <!-- Upload Tabs -->
                    <div class="flex border-b border-gray-200 mb-6">
                        <button class="upload-tab active" data-type="text">
                            <i class="fas fa-font mr-2"></i>Text Post
                        </button>
                        <button class="upload-tab" data-type="image">
                            <i class="fas fa-image mr-2"></i>Image Post
                        </button>
                        <button class="upload-tab" data-type="video">
                            <i class="fas fa-video mr-2"></i>Video Post
                        </button>
                    </div>

                    <!-- Text Post Form -->
                    <div id="textUpload" class="upload-form">
                        <form id="textPostForm">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Post Content</label>
                                <textarea id="textContent" rows="4" placeholder="What's on your mind?" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" required></textarea>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags (optional)</label>
                                <input type="text" id="textTags" placeholder="Enter tags separated by commas" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-paper-plane mr-2"></i>Publish Post
                            </button>
                        </form>
                    </div>

                    <!-- Image Post Form -->
                    <div id="imageUpload" class="upload-form hidden">
                        <form id="imagePostForm">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Upload Images</label>
                                <div class="upload-zone" id="imageDropzone">
                                    <input type="file" id="imageInput" multiple accept="image/*" class="hidden">
                                    <div class="text-center">
                                        <i class="fas fa-cloud-upload-alt text-4xl text-indigo-400 mb-4"></i>
                                        <p class="text-lg font-medium text-gray-700 mb-2">Drag & drop images here</p>
                                        <p class="text-sm text-gray-500">or click to select files</p>
                                        <p class="text-xs text-gray-400 mt-2">Supports: JPG, PNG, GIF (Max 10MB each)</p>
                                    </div>
                                </div>
                                <div id="imagePreview" class="mt-4 grid grid-cols-2 md:grid-cols-3 gap-4"></div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Caption</label>
                                <textarea id="imageCaption" rows="3" placeholder="Write a caption for your images..." class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags (optional)</label>
                                <input type="text" id="imageTags" placeholder="Enter tags separated by commas" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div class="mb-4">
                                <div class="progress-bar hidden" id="imageProgress">
                                    <div class="progress-fill"></div>
                                </div>
                            </div>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-images mr-2"></i>Publish Images
                            </button>
                        </form>
                    </div>

                    <!-- Video Post Form -->
                    <div id="videoUpload" class="upload-form hidden">
                        <form id="videoPostForm">
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Upload Video</label>
                                <div class="upload-zone" id="videoDropzone">
                                    <input type="file" id="videoInput" accept="video/*" class="hidden">
                                    <div class="text-center">
                                        <i class="fas fa-film text-4xl text-indigo-400 mb-4"></i>
                                        <p class="text-lg font-medium text-gray-700 mb-2">Drag & drop video here</p>
                                        <p class="text-sm text-gray-500">or click to select file</p>
                                        <p class="text-xs text-gray-400 mt-2">Supports: MP4, WebM, MOV (Max 100MB)</p>
                                    </div>
                                </div>
                                <div id="videoPreview" class="mt-4 hidden">
                                    <video id="previewVideo" controls playsinline webkit-playsinline class="w-full max-h-96 rounded-lg"></video>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                <textarea id="videoDescription" rows="3" placeholder="Describe your video..." class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                            </div>
                            <div class="mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tags (optional)</label>
                                <input type="text" id="videoTags" placeholder="Enter tags separated by commas" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                            </div>
                            <div class="mb-4">
                                <div class="progress-bar hidden" id="videoProgress">
                                    <div class="progress-fill"></div>
                                </div>
                            </div>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-video mr-2"></i>Publish Video
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile-page" class="page">
            <div class="card">
                <div class="p-6">
                    <div class="text-center mb-8">
                        <div class="relative inline-block">
                            <img id="profileAvatar" src="" alt="Profile" class="w-32 h-32 rounded-full mx-auto border-4 border-white shadow-lg">
                            <button class="absolute bottom-0 right-0 bg-indigo-500 text-white p-2 rounded-full hover:bg-indigo-600 transition-colors">
                                <i class="fas fa-camera"></i>
                            </button>
                        </div>
                        <h2 id="profileName" class="text-2xl font-bold text-gray-800 mt-4">User Name</h2>
                        <p id="profileEmail" class="text-gray-600">user@example.com</p>
                        <div class="flex justify-center mt-4 space-x-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">42</div>
                                <div class="text-sm text-gray-600">Posts</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">1.2K</div>
                                <div class="text-sm text-gray-600">Followers</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">567</div>
                                <div class="text-sm text-gray-600">Following</div>
                            </div>
                        </div>
                    </div>

                    <div class="border-t border-gray-200 pt-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">My Posts</h3>
                        <div id="userPosts" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- User posts will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page">
            <div class="card">
                <div class="p-6">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Settings</h2>
                    
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Account Information</h3>
                            <form id="profileForm">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Display Name</label>
                                        <input type="text" id="settingsName" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label>
                                        <input type="email" id="settingsEmail" class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500" readonly>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Bio</label>
                                    <textarea id="settingsBio" rows="3" placeholder="Tell us about yourself..." class="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
                                </div>
                                <div class="mt-6">
                                    <button type="submit" class="btn-primary">
                                        <i class="fas fa-save mr-2"></i>Save Changes
                                    </button>
                                </div>
                            </form>
                        </div>

                        <div class="border-t border-gray-200 pt-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Privacy Settings</h3>
                            <div class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-medium text-gray-800">Profile Visibility</h4>
                                        <p class="text-sm text-gray-600">Control who can see your profile</p>
                                    </div>
                                    <select class="p-2 border border-gray-300 rounded-lg">
                                        <option>Public</option>
                                        <option>Friends Only</option>
                                        <option>Private</option>
                                    </select>
                                </div>
                                
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h4 class="font-medium text-gray-800">Allow Comments</h4>
                                        <p class="text-sm text-gray-600">Let others comment on your posts</p>
                                    </div>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" checked class="sr-only peer">
                                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-gray-200 pt-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Dangerous Actions</h3>
                            <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                                <button class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium">
                                    <i class="fas fa-trash mr-2"></i>Delete Account
                                </button>
                                <p class="text-sm text-red-600 mt-2">This action cannot be undone. All your data will be permanently deleted.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <script>
        // Global variables
        let currentUser = null;
        let selectedFiles = [];
        let uploadProgress = {};

        // Initialize app
        window.initializeApp = function() {
            setupAuthListeners();
            setupNavigation();
            setupUploadForms();
            setupEventListeners();
            
            // Check authentication state
            window.firebaseServices.onAuthStateChanged(window.firebaseAuth, (user) => {
                if (user) {
                    currentUser = user;
                    showMainApp();
                    loadUserData();
                    loadPosts();
                } else {
                    currentUser = null;
                    showAuthModal();
                }
            });
        };

        // Authentication functions
        function setupAuthListeners() {
            const authModal = document.getElementById('authModal');
            const authForm = document.getElementById('authForm');
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            const googleAuth = document.getElementById('googleAuth');
            const logoutBtn = document.getElementById('logoutBtn');

            // Tab switching
            loginTab.addEventListener('click', () => switchAuthTab('login'));
            registerTab.addEventListener('click', () => switchAuthTab('register'));

            // Form submission
            authForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const email = document.getElementById('authEmail').value;
                const password = document.getElementById('authPassword').value;
                const name = document.getElementById('authName').value;
                const isRegister = registerTab.classList.contains('border-indigo-500');

                try {
                    if (isRegister) {
                        await window.firebaseServices.createUserWithEmailAndPassword(window.firebaseAuth, email, password);
                        // Save user profile
                        await window.firebaseServices.addDoc(window.firebaseServices.collection(window.firebaseDB, 'users'), {
                            uid: window.firebaseAuth.currentUser.uid,
                            name: name || 'User',
                            email: email,
                            bio: '',
                            createdAt: window.firebaseServices.serverTimestamp()
                        });
                        showNotification('Account created successfully!', 'success');
                    } else {
                        await window.firebaseServices.signInWithEmailAndPassword(window.firebaseAuth, email, password);
                        showNotification('Welcome back!', 'success');
                    }
                } catch (error) {
                    showNotification(error.message, 'error');
                }
            });

            // Google Auth
            googleAuth.addEventListener('click', async () => {
                try {
                    const provider = new window.firebaseServices.GoogleAuthProvider();
                    await window.firebaseServices.signInWithPopup(window.firebaseAuth, provider);
                    showNotification('Signed in with Google!', 'success');
                } catch (error) {
                    showNotification(error.message, 'error');
                }
            });

            // Logout
            logoutBtn.addEventListener('click', async () => {
                try {
                    await window.firebaseServices.signOut(window.firebaseAuth);
                    showNotification('Signed out successfully!', 'success');
                } catch (error) {
                    showNotification(error.message, 'error');
                }
            });
        }

        function switchAuthTab(tab) {
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            const registerFields = document.getElementById('registerFields');
            const authButtonText = document.getElementById('authButtonText');

            if (tab === 'login') {
                loginTab.classList.add('border-indigo-500', 'text-indigo-600');
                loginTab.classList.remove('border-gray-200', 'text-gray-500');
                registerTab.classList.add('border-gray-200', 'text-gray-500');
                registerTab.classList.remove('border-indigo-500', 'text-indigo-600');
                registerFields.classList.add('hidden');
                authButtonText.textContent = 'Sign In';
            } else {
                registerTab.classList.add('border-indigo-500', 'text-indigo-600');
                registerTab.classList.remove('border-gray-200', 'text-gray-500');
                loginTab.classList.add('border-gray-200', 'text-gray-500');
                loginTab.classList.remove('border-indigo-500', 'text-indigo-600');
                registerFields.classList.remove('hidden');
                authButtonText.textContent = 'Sign Up';
            }
        }

        function showAuthModal() {
            document.getElementById('authModal').classList.add('show');
            document.getElementById('mainNav').classList.add('hidden');
            document.getElementById('userInfo').classList.add('hidden');
        }

        function showMainApp() {
            document.getElementById('authModal').classList.remove('show');
            document.getElementById('mainNav').classList.remove('hidden');
            document.getElementById('userInfo').classList.remove('hidden');
        }

        // Navigation
        function setupNavigation() {
            const navLinks = document.querySelectorAll('.nav-link');
            const pages = document.querySelectorAll('.page');

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetPage = link.getAttribute('data-page');
                    
                    // Update active nav
                    navLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    
                    // Show target page
                    pages.forEach(page => {
                        if (page.id === `${targetPage}-page`) {
                            page.classList.add('active');
                        } else {
                            page.classList.remove('active');
                        }
                    });
                });
            });
        }

        // Upload forms
        function setupUploadForms() {
            // Tab switching
            const uploadTabs = document.querySelectorAll('.upload-tab');
            const uploadForms = document.querySelectorAll('.upload-form');

            uploadTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const type = tab.getAttribute('data-type');
                    
                    uploadTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    uploadForms.forEach(form => {
                        if (form.id === `${type}Upload`) {
                            form.classList.remove('hidden');
                        } else {
                            form.classList.add('hidden');
                        }
                    });
                });
            });

            // Image upload
            setupImageUpload();
            
            // Video upload
            setupVideoUpload();
            
            // Form submissions
            setupFormSubmissions();
        }

        function setupImageUpload() {
            const imageDropzone = document.getElementById('imageDropzone');
            const imageInput = document.getElementById('imageInput');
            const imagePreview = document.getElementById('imagePreview');

            imageDropzone.addEventListener('click', () => imageInput.click());
            
            imageDropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                imageDropzone.classList.add('border-indigo-500');
            });
            
            imageDropzone.addEventListener('dragleave', () => {
                imageDropzone.classList.remove('border-indigo-500');
            });
            
            imageDropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                imageDropzone.classList.remove('border-indigo-500');
                handleImageFiles(e.dataTransfer.files);
            });
            
            imageInput.addEventListener('change', (e) => {
                handleImageFiles(e.target.files);
            });

            function handleImageFiles(files) {
                selectedFiles = Array.from(files);
                imagePreview.innerHTML = '';
                
                selectedFiles.forEach((file, index) => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const preview = document.createElement('div');
                            preview.className = 'relative';
                            preview.innerHTML = `
                                <img src="${e.target.result}" alt="Preview" class="w-full h-32 object-cover rounded-lg">
                                <button type="button" onclick="removeFile(${index})" class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm">×</button>
                            `;
                            imagePreview.appendChild(preview);
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        }

        function setupVideoUpload() {
            const videoDropzone = document.getElementById('videoDropzone');
            const videoInput = document.getElementById('videoInput');
            const videoPreview = document.getElementById('videoPreview');
            const previewVideo = document.getElementById('previewVideo');

            videoDropzone.addEventListener('click', () => videoInput.click());
            
            videoDropzone.addEventListener('dragover', (e) => {
                e.preventDefault();
                videoDropzone.classList.add('border-indigo-500');
            });
            
            videoDropzone.addEventListener('dragleave', () => {
                videoDropzone.classList.remove('border-indigo-500');
            });
            
            videoDropzone.addEventListener('drop', (e) => {
                e.preventDefault();
                videoDropzone.classList.remove('border-indigo-500');
                handleVideoFile(e.dataTransfer.files[0]);
            });
            
            videoInput.addEventListener('change', (e) => {
                handleVideoFile(e.target.files[0]);
            });

            function handleVideoFile(file) {
                if (file && file.type.startsWith('video/')) {
                    selectedFiles = [file];
                    const videoURL = URL.createObjectURL(file);
                    previewVideo.src = videoURL;
                    videoPreview.classList.remove('hidden');
                }
            }
        }

        function setupFormSubmissions() {
            // Text post form
            document.getElementById('textPostForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                const content = document.getElementById('textContent').value;
                const tags = document.getElementById('textTags').value;
                
                await createPost('text', {
                    content,
                    tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag)
                });
            });

            // Image post form
            document.getElementById('imagePostForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                if (selectedFiles.length === 0) {
                    showNotification('Please select at least one image', 'error');
                    return;
                }
                
                const caption = document.getElementById('imageCaption').value;
                const tags = document.getElementById('imageTags').value;
                
                await createPost('image', {
                    caption,
                    tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag),
                    files: selectedFiles
                });
            });

            // Video post form
            document.getElementById('videoPostForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                if (selectedFiles.length === 0) {
                    showNotification('Please select a video file', 'error');
                    return;
                }
                
                const description = document.getElementById('videoDescription').value;
                const tags = document.getElementById('videoTags').value;
                
                await createPost('video', {
                    description,
                    tags: tags.split(',').map(tag => tag.trim()).filter(tag => tag),
                    files: selectedFiles
                });
            });
        }

        // Create post function
        async function createPost(type, data) {
            try {
                const postData = {
                    type,
                    authorId: currentUser.uid,
                    authorName: currentUser.displayName || 'User',
                    authorAvatar: currentUser.photoURL || '',
                    createdAt: window.firebaseServices.serverTimestamp(),
                    likes: 0,
                    comments: 0
                };

                if (type === 'text') {
                    postData.content = data.content;
                    postData.tags = data.tags;
                } else if (type === 'image') {
                    postData.caption = data.caption;
                    postData.tags = data.tags;
                    postData.images = await uploadFiles(data.files, 'images');
                } else if (type === 'video') {
                    postData.description = data.description;
                    postData.tags = data.tags;
                    postData.videos = await uploadFiles(data.files, 'videos');
                }

                await window.firebaseServices.addDoc(
                    window.firebaseServices.collection(window.firebaseDB, 'posts'),
                    postData
                );

                showNotification('Post created successfully!', 'success');
                resetUploadForms();
                loadPosts();

            } catch (error) {
                console.error('Error creating post:', error);
                showNotification('Failed to create post', 'error');
            }
        }

        // Upload files to Firebase Storage
        async function uploadFiles(files, folder) {
            const uploadPromises = files.map(async (file, index) => {
                const fileName = `${Date.now()}_${index}_${file.name}`;
                const storageRef = window.firebaseServices.ref(window.firebaseStorage, `${folder}/${fileName}`);
                
                return new Promise((resolve, reject) => {
                    const uploadTask = window.firebaseServices.uploadBytesResumable(storageRef, file);
                    
                    uploadTask.on('state_changed',
                        (snapshot) => {
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            updateUploadProgress(folder, progress);
                        },
                        (error) => reject(error),
                        async () => {
                            const downloadURL = await window.firebaseServices.getDownloadURL(uploadTask.snapshot.ref);
                            resolve(downloadURL);
                        }
                    );
                });
            });

            return Promise.all(uploadPromises);
        }

        function updateUploadProgress(type, progress) {
            const progressBar = document.getElementById(`${type === 'images' ? 'image' : 'video'}Progress`);
            const progressFill = progressBar.querySelector('.progress-fill');
            
            progressBar.classList.remove('hidden');
            progressFill.style.width = `${progress}%`;
            
            if (progress === 100) {
                setTimeout(() => {
                    progressBar.classList.add('hidden');
                    progressFill.style.width = '0%';
                }, 1000);
            }
        }

        // Load posts
        async function loadPosts() {
            try {
                const postsQuery = window.firebaseServices.query(
                    window.firebaseServices.collection(window.firebaseDB, 'posts'),
                    window.firebaseServices.orderBy('createdAt', 'desc'),
                    window.firebaseServices.limit(10)
                );

                window.firebaseServices.onSnapshot(postsQuery, (snapshot) => {
                    const postsContainer = document.getElementById('postsContainer');
                    
                    // Keep existing sample posts and add new ones
                    const existingPosts = postsContainer.innerHTML;
                    let newPostsHTML = '';

                    snapshot.docs.forEach((doc) => {
                        const post = doc.data();
                        newPostsHTML += createPostHTML(post, doc.id);
                    });

                    if (newPostsHTML) {
                        postsContainer.innerHTML = newPostsHTML + existingPosts;
                    }
                });

            } catch (error) {
                console.error('Error loading posts:', error);
            }
        }

        function createPostHTML(post, postId) {
            const timeAgo = post.createdAt ? 'Just now' : 'Loading...';
            let mediaHTML = '';

            if (post.type === 'image' && post.images) {
                mediaHTML = post.images.map(url => 
                    `<img src="${url}" alt="Post image" class="post-image mb-3">`
                ).join('');
            } else if (post.type === 'video' && post.videos) {
                mediaHTML = post.videos.map(url => 
                    `<video controls playsinline webkit-playsinline class="post-video mb-3">
                        <source src="${url}" type="video/mp4">
                    </video>`
                ).join('');
            }

            const tagsHTML = post.tags ? post.tags.map(tag => 
                `<span class="bg-indigo-100 text-indigo-800 text-xs px-2 py-1 rounded-full">#${tag}</span>`
            ).join(' ') : '';

            return `
                <div class="card fade-in">
                    <div class="p-6">
                        <div class="flex items-center mb-4">
                            <img src="${post.authorAvatar || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face'}" alt="User" class="user-avatar mr-4">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">${post.authorName}</h4>
                                <p class="text-sm text-gray-500">${timeAgo}</p>
                            </div>
                            <button class="text-gray-400 hover:text-gray-600">
                                <i class="fas fa-ellipsis-h"></i>
                            </button>
                        </div>
                        
                        <div class="mb-4">
                            ${post.content ? `<p class="text-gray-800 mb-3">${post.content}</p>` : ''}
                            ${post.caption ? `<p class="text-gray-800 mb-3">${post.caption}</p>` : ''}
                            ${post.description ? `<p class="text-gray-800 mb-3">${post.description}</p>` : ''}
                            ${mediaHTML}
                            <div class="flex flex-wrap gap-2">
                                ${tagsHTML}
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center py-3 border-t border-gray-100">
                            <button class="flex items-center text-gray-600 hover:text-red-500 transition-colors" onclick="likePost('${postId}')">
                                <i class="far fa-heart mr-2"></i>
                                <span>${post.likes || 0} Likes</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-indigo-500 transition-colors">
                                <i class="far fa-comment mr-2"></i>
                                <span>${post.comments || 0} Comments</span>
                            </button>
                            <button class="flex items-center text-gray-600 hover:text-green-500 transition-colors">
                                <i class="fas fa-share mr-2"></i>
                                <span>Share</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load user data
        function loadUserData() {
            if (currentUser) {
                document.getElementById('userName').textContent = currentUser.displayName || 'User';
                document.getElementById('userAvatar').src = currentUser.photoURL || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=50&h=50&fit=crop&crop=face';
                document.getElementById('profileAvatar').src = currentUser.photoURL || 'https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=128&h=128&fit=crop&crop=face';
                document.getElementById('profileName').textContent = currentUser.displayName || 'User';
                document.getElementById('profileEmail').textContent = currentUser.email;
                document.getElementById('settingsName').value = currentUser.displayName || '';
                document.getElementById('settingsEmail').value = currentUser.email;
            }
        }

        // Utility functions
        function resetUploadForms() {
            document.getElementById('textPostForm').reset();
            document.getElementById('imagePostForm').reset();
            document.getElementById('videoPostForm').reset();
            document.getElementById('imagePreview').innerHTML = '';
            document.getElementById('videoPreview').classList.add('hidden');
            selectedFiles = [];
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            document.getElementById('imageInput').value = '';
            // Refresh preview
            const event = new Event('change');
            document.getElementById('imageInput').dispatchEvent(event);
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.getElementById('notificationContainer').appendChild(notification);
            
            setTimeout(() => notification.classList.add('show'), 100);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function setupEventListeners() {
            // Upload tabs
            const uploadTabs = document.querySelectorAll('.upload-tab');
            uploadTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    uploadTabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                });
            });

            // Add upload tab styles
            const style = document.createElement('style');
            style.textContent = `
                .upload-tab {
                    padding: 0.75rem 1.5rem;
                    border-bottom: 2px solid transparent;
                    color: #6b7280;
                    cursor: pointer;
                    transition: all 0.3s ease;
                }
                .upload-tab.active {
                    color: #4f46e5;
                    border-bottom-color: #4f46e5;
                    font-weight: 600;
                }
                .upload-tab:hover {
                    color: #4f46e5;
                }
            `;
            document.head.appendChild(style);
        }

        // Like post function
        async function likePost(postId) {
            try {
                const postRef = window.firebaseServices.doc(window.firebaseDB, 'posts', postId);
                const postDoc = await window.firebaseServices.getDocs(window.firebaseServices.collection(window.firebaseDB, 'posts'));
                
                // Find the post and increment likes
                // This is a simplified version - in a real app, you'd track who liked what
                showNotification('Post liked!', 'success');
            } catch (error) {
                console.error('Error liking post:', error);
            }
        }

        // Make functions globally available
        window.removeFile = removeFile;
        window.likePost = likePost;
    </script>
</body>
</html>
